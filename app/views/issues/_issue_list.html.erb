<div class="table-responsive">
	<div id="sample-table-2_wrapper" class="dataTables_wrapper" role="grid">
		<table id="sample-table-2" class="table table-striped table-bordered table-hover dataTable" aria-describedby="sample-table-2_info">
			<thead>
				<tr role="row">
					<th class="sorting" role="columnheader" tabindex="0" aria-controls="sample-table-2" rowspan="1" colspan="1" aria-label="Domain: activate to sort column ascending" style="width: 80px;">S. No.</th>
					<th class="sorting" role="columnheader" tabindex="0" aria-controls="sample-table-2" rowspan="1" colspan="1" aria-label="Domain: activate to sort column ascending" style="width: 150px;">Issue Title</th>
					<th class="sorting" role="columnheader" tabindex="0" aria-controls="sample-table-2" rowspan="1" colspan="1" aria-label="Price: activate to sort column ascending" style="width: 108px;">Description</th>
					<th class="hidden-480 sorting" role="columnheader" tabindex="0" aria-controls="sample-table-2" rowspan="1" colspan="1" aria-label="Clicks: activate to sort column ascending" style="width: 118px;">Area</th>
					<th class="sorting" role="columnheader" tabindex="0" aria-controls="sample-table-2" rowspan="1" colspan="1" aria-label="Update: activate to sort column ascending" style="width: 178px;">Area Code</th>
					<th class="hidden-480 sorting" role="columnheader" tabindex="0" aria-controls="sample-table-2" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 145px;">Status</th>
					<th class="sorting_disabled" role="columnheader" rowspan="1" colspan="1" aria-label="" style="width: 156px;"></th>
				</tr>
			</thead>
			<tbody role="alert" aria-live="polite" aria-relevant="all">
				<%  @issues.each_with_index do |iss,i| %>
					<tr>
						<% interested_ngos = iss.users.where(role: "NGO").to_a.map{|x| [x.name, x.id]} %>
						<td><%= i + 1 %></td>
						<td><%= iss.issue_title %></td>
						<td><%= iss.issue_description %></td>
						<td><%= iss.issue_area %></td>
						<td><%= iss.issue_area_code %></td>
						<td><%= iss.issue_status ? "Open" : "Closed" %></td>
						<td>
							<div class="visible-md visible-lg hidden-sm hidden-xs btn-group">
								<a href="<%= issue_path(iss.id) %>" class="btn btn-xs btn-info"><i class="icon-eye-open bigger-120"></i></a>
								<% if iss.issue_status%>
									<a href="<%= edit_issue_path(id: iss.id) %>" class="btn btn-xs btn-danger"><i class="icon-edit bigger-120"></i></a>
								<% else %>
									<a disabled="disabled" class="btn btn-xs btn-danger"><i class="icon-edit bigger-120"></i></a>
								<% end %>
								<%if current_user.role == "NGO"%>
									<%if iss.users.all.include?(current_user) and !iss.issue_status %>
										<a id="int_btn_<%= iss.id%>" disabled="disabled" class="btn btn-xs btn-info"><i class="icon-download-alt bigger-120"></i></a>
									<%else%>
										<a id="int_btn_<%= iss.id%>" onClick="return setInterestedNgo(<%= iss.id %>);" class="btn btn-xs btn-info"><i class="icon-download-alt bigger-120"></i></a>
									<%end%>
								<%end%>
							</div>
						</td>
					</tr>
				<% end %>
			</tbody>
		</table>
	</div>
</div>
<% unless @issues.present? %>
	<div class="col-xs-12">
		<% if @comp %>
			<b>No completed issue(s)</b>
		<% else %>
			<b>You have not submitted any issue(s)</b>
		<% end %>
	</div>
<% end %>

<script>
	function setInterestedNgo(issue_id){
		var u_id = <%= current_user.id%>
		$.ajax({ 
			type: "GET",
			dataType: "json",
			data: {issue_id: issue_id, user_id: u_id},
			url: "/issues/interested_ngos",
			success: function (result) {
				var btn_name = '#int_btn_'+result.iss_id
				$(btn_name).attr("disabled", true);
				$(btn_name).attr("value","Interest Shown");
			}
		});
	}
</script>